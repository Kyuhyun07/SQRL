
R version 3.6.3 (2020-02-29) -- "Holding the Windsock"
Copyright (C) 2020 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> setwd('/home/schiou/RPackages/qrismb/R/')
> + + + + + + + + + + + + + + + + + + + + > datGen <- function(n, cp, sce, q) {
+     k <- 2
+     X <- model.matrix(~ sample(0:1, n, TRUE))
+     ## Calculate b
+     b0 <- log(5)
+     t0 <- 0:3
+     if (sce == 1) b <- matrix(c(1.609438, 1.410748, 1.219403, 1.040613 , 0, 0, 0, 0), 4)
+     else b <- matrix(c(1.609438, 1.410748, 1.219403, .... [TRUNCATED] 
> head(10, .1, 1, .25)
numeric(0)
> head(do(10, .1, 1, .25))
Error in do(10, 0.1, 1, 0.25) : could not find function "do"
> head(datGen(10, .1, 1, .25))
       Z.1       Z.2       Z.3       Z.4 X.1 X.2 d.1 d.2 d.3 d.4
1 2.477625 2.0311672 1.6774346 1.4028075   1   1   1   1   1   1
2 2.732986 2.2405130 1.8503223 1.5473903   1   1   1   1   1   1
3 1.127184 0.9240698 0.7631408 0.6382006   1   1   1   1   1   1
4 2.713603 2.2246222 1.8371989 1.5364155   1   0   1   1   1   1
5 2.390098 1.9594122 1.6181759 1.3532505   1   0   1   1   1   1
6 2.801042 2.2963058 1.8963987 1.5859231   1   1   1   1   1   1
> head(datGen(10, .1, 1, .25), 10)
        Z.1      Z.2       Z.3       Z.4 X.1 X.2 d.1 d.2 d.3 d.4
1  5.109428 4.188729 3.4592523 2.8929087   1   1   1   1   1   1
2  3.485522 2.764834 2.3598144 1.9734691   1   1   1   0   1   1
3  1.243002 1.019018 0.8415539 0.7037759   1   0   1   1   1   1
4  4.233976 3.471030 2.8665420 2.3972361   1   0   1   1   1   1
5  7.002728 5.740864 3.0618204 3.9648766   1   1   1   1   0   1
6  3.547068 2.907900 2.4014827 2.0083155   1   0   1   1   1   1
7  3.180214 2.607152 2.1531107 1.8006066   1   1   1   1   1   1
8  3.122175 2.559572 2.1138161 1.7677453   1   0   1   1   1   1
9  1.755248 1.438960 1.1883614 0.9938047   1   0   1   1   1   1
10 6.721510 5.510320 4.5506850 3.8056537   1   1   1   1   1   1
> head(datGen(10, .5, 1, .25), 10)
         Z.1       Z.2       Z.3       Z.4 X.1 X.2 d.1 d.2 d.3 d.4
1  3.0607436 2.5092098 0.5944341 1.7329634   1   0   1   1   0   1
2  3.8785932 0.2310637 2.0119921 2.1960220   1   0   1   0   0   1
3  0.1382159 2.7473030 2.2688536 1.8974003   1   0   0   1   1   1
4  2.1091894 1.0529970 1.4279912 1.1942026   1   0   1   0   1   1
5  3.7648718 3.0864569 1.6822289 2.1316340   1   1   1   1   0   1
6  2.9131465 2.3882091 1.9722968 1.6493954   1   1   1   1   1   1
7  6.2206539 3.9432839 0.9426912 3.5220741   1   0   1   0   0   1
8  3.2300372 4.2557079 3.5145663 2.9391668   1   0   0   1   1   1
9  2.3463049 1.9235101 1.5885263 1.3284551   1   0   1   1   1   1
10 1.5023151 1.2316039 1.0171172 0.8505963   1   0   1   1   1   1
> summary(datGen(100, .5, 1, .25), 10)
      Z.1              Z.2               Z.3             Z.4        
 Min.   :0.2318   Min.   :0.07503   Min.   :0.240   Min.   :0.1702  
 1st Qu.:2.3038   1st Qu.:1.69886   1st Qu.:1.460   1st Qu.:1.3281  
 Median :3.3974   Median :2.52942   Median :2.142   Median :1.9288  
 Mean   :3.6574   Mean   :2.73600   Mean   :2.313   Mean   :2.0460  
 3rd Qu.:4.9027   3rd Qu.:3.72217   3rd Qu.:3.154   3rd Qu.:2.6518  
 Max.   :8.2783   Max.   :6.53829   Max.   :5.605   Max.   :4.6871  
      X.1         X.2            d.1            d.2            d.3      
 Min.   :1   Min.   :0.00   Min.   :0.00   Min.   :0.00   Min.   :0.00  
 1st Qu.:1   1st Qu.:0.00   1st Qu.:1.00   1st Qu.:1.00   1st Qu.:1.00  
 Median :1   Median :0.00   Median :1.00   Median :1.00   Median :1.00  
 Mean   :1   Mean   :0.45   Mean   :0.87   Mean   :0.77   Mean   :0.78  
 3rd Qu.:1   3rd Qu.:1.00   3rd Qu.:1.00   3rd Qu.:1.00   3rd Qu.:1.00  
 Max.   :1   Max.   :1.00   Max.   :1.00   Max.   :1.00   Max.   :1.00  
      d.4      
 Min.   :0.00  
 1st Qu.:1.00  
 Median :1.00  
 Mean   :0.85  
 3rd Qu.:1.00  
 Max.   :1.00  
> summary(datGen(5000, .5, 1, .25), 10)
      Z.1                Z.2               Z.3               Z.4          
 Min.   : 0.02182   Min.   :0.02685   Min.   :0.02809   Min.   :0.002401  
 1st Qu.: 1.98664   1st Qu.:1.44888   1st Qu.:1.23516   1st Qu.:1.089143  
 Median : 3.16941   Median :2.39615   Median :2.05600   Median :1.779339  
 Mean   : 3.38353   Mean   :2.59817   Mean   :2.21059   Mean   :1.896557  
 3rd Qu.: 4.51113   3rd Qu.:3.54759   3rd Qu.:3.02257   3rd Qu.:2.570622  
 Max.   :10.74728   Max.   :8.81067   Max.   :7.27627   Max.   :5.695126  
      X.1         X.2             d.1             d.2             d.3       
 Min.   :1   Min.   :0.000   Min.   :0.000   Min.   :0.000   Min.   :0.000  
 1st Qu.:1   1st Qu.:0.000   1st Qu.:1.000   1st Qu.:1.000   1st Qu.:1.000  
 Median :1   Median :0.000   Median :1.000   Median :1.000   Median :1.000  
 Mean   :1   Mean   :0.471   Mean   :0.836   Mean   :0.769   Mean   :0.799  
 3rd Qu.:1   3rd Qu.:1.000   3rd Qu.:1.000   3rd Qu.:1.000   3rd Qu.:1.000  
 Max.   :1   Max.   :1.000   Max.   :1.000   Max.   :1.000   Max.   :1.000  
      d.4       
 Min.   :0.000  
 1st Qu.:1.000  
 Median :1.000  
 Mean   :0.827  
 3rd Qu.:1.000  
 Max.   :1.000  
> summary(datGen(5000, .5, 1, .25), 10)
      Z.1                 Z.2                Z.3                Z.4          
 Min.   : 0.000572   Min.   :0.003729   Min.   :0.000003   Min.   :0.004402  
 1st Qu.: 1.908295   1st Qu.:1.456543   1st Qu.:1.254923   1st Qu.:1.087947  
 Median : 3.185002   Median :2.480475   Median :2.114448   Median :1.803354  
 Mean   : 3.380421   Mean   :2.650008   Mean   :2.249734   Mean   :1.922324  
 3rd Qu.: 4.580184   3rd Qu.:3.614374   3rd Qu.:3.063007   3rd Qu.:2.598306  
 Max.   :11.227401   Max.   :9.539012   Max.   :7.939357   Max.   :6.356846  
      X.1         X.2             d.1              d.2              d.3       
 Min.   :1   Min.   :0.000   Min.   :0.0000   Min.   :0.0000   Min.   :0.000  
 1st Qu.:1   1st Qu.:0.000   1st Qu.:1.0000   1st Qu.:1.0000   1st Qu.:1.000  
 Median :1   Median :0.000   Median :1.0000   Median :1.0000   Median :1.000  
 Mean   :1   Mean   :0.492   Mean   :0.8364   Mean   :0.7744   Mean   :0.808  
 3rd Qu.:1   3rd Qu.:1.000   3rd Qu.:1.0000   3rd Qu.:1.0000   3rd Qu.:1.000  
 Max.   :1   Max.   :1.000   Max.   :1.0000   Max.   :1.0000   Max.   :1.000  
      d.4        
 Min.   :0.0000  
 1st Qu.:1.0000  
 Median :1.0000  
 Mean   :0.8386  
 3rd Qu.:1.0000  
 Max.   :1.0000  
> summary(datGen(5000, .7, 1, .25), 10)
      Z.1                 Z.2                Z.3                Z.4          
 Min.   : 0.000449   Min.   :0.000348   Min.   :0.000882   Min.   :0.002518  
 1st Qu.: 1.631628   1st Qu.:1.243372   1st Qu.:1.082798   1st Qu.:0.966940  
 Median : 2.843154   Median :2.179667   Median :1.882128   Median :1.657452  
 Mean   : 3.056295   Mean   :2.353313   Mean   :2.013004   Mean   :1.769724  
 3rd Qu.: 4.239643   3rd Qu.:3.253308   3rd Qu.:2.785359   3rd Qu.:2.440922  
 Max.   :11.230693   Max.   :8.455151   Max.   :6.919293   Max.   :6.371143  
      X.1         X.2             d.1              d.2              d.3        
 Min.   :1   Min.   :0.000   Min.   :0.0000   Min.   :0.0000   Min.   :0.0000  
 1st Qu.:1   1st Qu.:0.000   1st Qu.:0.0000   1st Qu.:0.0000   1st Qu.:0.0000  
 Median :1   Median :0.000   Median :1.0000   Median :1.0000   Median :1.0000  
 Mean   :1   Mean   :0.499   Mean   :0.7302   Mean   :0.6466   Mean   :0.6926  
 3rd Qu.:1   3rd Qu.:1.000   3rd Qu.:1.0000   3rd Qu.:1.0000   3rd Qu.:1.0000  
 Max.   :1   Max.   :1.000   Max.   :1.0000   Max.   :1.0000   Max.   :1.0000  
      d.4        
 Min.   :0.0000  
 1st Qu.:1.0000  
 Median :1.0000  
 Mean   :0.7508  
 3rd Qu.:1.0000  
 Max.   :1.0000  
> summary(datGen(5000, .1, 2, .25), 10)
      Z.1                 Z.2                Z.3                Z.4          
 Min.   : 0.008427   Min.   :0.003282   Min.   :0.002507   Min.   :0.001205  
 1st Qu.: 1.966590   1st Qu.:1.452733   1st Qu.:1.312128   1st Qu.:1.209275  
 Median : 3.488218   Median :2.623369   Median :2.355232   Median :2.146502  
 Mean   : 4.002473   Mean   :2.946171   Mean   :2.723286   Mean   :2.571674  
 3rd Qu.: 5.500719   3rd Qu.:4.156858   3rd Qu.:3.803031   3rd Qu.:3.579697  
 Max.   :14.159981   Max.   :8.485800   Max.   :8.345528   Max.   :8.484246  
      X.1         X.2              d.1              d.2        
 Min.   :1   Min.   :0.0000   Min.   :0.0000   Min.   :0.0000  
 1st Qu.:1   1st Qu.:0.0000   1st Qu.:0.0000   1st Qu.:0.0000  
 Median :1   Median :0.0000   Median :1.0000   Median :0.0000  
 Mean   :1   Mean   :0.4988   Mean   :0.5988   Mean   :0.4684  
 3rd Qu.:1   3rd Qu.:1.0000   3rd Qu.:1.0000   3rd Qu.:1.0000  
 Max.   :1   Max.   :1.0000   Max.   :1.0000   Max.   :1.0000  
      d.3              d.4        
 Min.   :0.0000   Min.   :0.0000  
 1st Qu.:0.0000   1st Qu.:0.0000  
 Median :1.0000   Median :1.0000  
 Mean   :0.5052   Mean   :0.5456  
 3rd Qu.:1.0000   3rd Qu.:1.0000  
 Max.   :1.0000   Max.   :1.0000  
> summary(datGen(5000, .1, 2, .25), 10)
      Z.1                Z.2                Z.3                 Z.4          
 Min.   : 0.01096   Min.   : 0.04055   Min.   : 0.001213   Min.   : 0.01894  
 1st Qu.: 2.77340   1st Qu.: 2.30653   1st Qu.: 1.977709   1st Qu.: 1.68554  
 Median : 4.58312   Median : 3.86984   Median : 3.384953   Median : 2.96103  
 Mean   : 5.44156   Mean   : 4.73218   Mean   : 4.238274   Mean   : 3.84099  
 3rd Qu.: 7.33816   3rd Qu.: 6.47996   3rd Qu.: 5.861441   3rd Qu.: 5.44874  
 Max.   :25.64244   Max.   :23.33211   Max.   :21.501614   Max.   :20.08047  
      X.1         X.2             d.1              d.2              d.3        
 Min.   :1   Min.   :0.000   Min.   :0.0000   Min.   :0.0000   Min.   :0.0000  
 1st Qu.:1   1st Qu.:0.000   1st Qu.:1.0000   1st Qu.:1.0000   1st Qu.:1.0000  
 Median :1   Median :1.000   Median :1.0000   Median :1.0000   Median :1.0000  
 Mean   :1   Mean   :0.517   Mean   :0.9464   Mean   :0.9294   Mean   :0.9358  
 3rd Qu.:1   3rd Qu.:1.000   3rd Qu.:1.0000   3rd Qu.:1.0000   3rd Qu.:1.0000  
 Max.   :1   Max.   :1.000   Max.   :1.0000   Max.   :1.0000   Max.   :1.0000  
      d.4       
 Min.   :0.000  
 1st Qu.:1.000  
 Median :1.000  
 Mean   :0.934  
 3rd Qu.:1.000  
 Max.   :1.000  
> summary(datGen(5000, .3, 2, .25), 10)
      Z.1                Z.2                 Z.3                 Z.4           
 Min.   : 0.00281   Min.   : 0.004414   Min.   : 0.001241   Min.   : 0.003288  
 1st Qu.: 2.66046   1st Qu.: 2.053925   1st Qu.: 1.789563   1st Qu.: 1.552380  
 Median : 4.43202   Median : 3.505106   Median : 3.071436   Median : 2.650889  
 Mean   : 5.14837   Mean   : 4.207027   Mean   : 3.823954   Mean   : 3.430777  
 3rd Qu.: 6.96023   3rd Qu.: 5.670282   3rd Qu.: 5.196509   3rd Qu.: 4.644933  
 Max.   :24.28521   Max.   :22.511991   Max.   :18.435190   Max.   :16.493918  
      X.1         X.2             d.1              d.2             d.3        
 Min.   :1   Min.   :0.000   Min.   :0.0000   Min.   :0.000   Min.   :0.0000  
 1st Qu.:1   1st Qu.:0.000   1st Qu.:1.0000   1st Qu.:1.000   1st Qu.:1.0000  
 Median :1   Median :0.000   Median :1.0000   Median :1.000   Median :1.0000  
 Mean   :1   Mean   :0.495   Mean   :0.8714   Mean   :0.794   Mean   :0.8162  
 3rd Qu.:1   3rd Qu.:1.000   3rd Qu.:1.0000   3rd Qu.:1.000   3rd Qu.:1.0000  
 Max.   :1   Max.   :1.000   Max.   :1.0000   Max.   :1.000   Max.   :1.0000  
      d.4       
 Min.   :0.000  
 1st Qu.:1.000  
 Median :1.000  
 Mean   :0.826  
 3rd Qu.:1.000  
 Max.   :1.000  
> + + > x <- matrix(1:6, 3)
> x
     [,1] [,2]
[1,]    1    4
[2,]    2    5
[3,]    3    6
> apply(x, 1, cumsum)
     [,1] [,2] [,3]
[1,]    1    2    3
[2,]    5    7    9
> debug(datGen)
> datGen(10, .1, 1, q)
debugging in: datGen(10, 0.1, 1, q)
debug at /tmp/simdat.R!1724kxk#1: {
    k <- 2
    X <- model.matrix(~sample(0:1, n, TRUE))
    b0 <- log(5)
    t0 <- 0:3
    if (sce == 1) 
        b <- matrix(c(1.609438, 1.410748, 1.219403, 1.040613, 
            0, 0, 0, 0), 4)
    else b <- matrix(c(1.609438, 1.410748, 1.219403, 1.040613, 
        0.6931472, 0.7974189, 0.9070615, 1.0174711), 4)
    u <- runif(n)
    if (cp == Inf) 
        cen <- Inf
    if (cp == 0.1) 
        cen <- t(matrix(runif(4 * n, 0, c(123.69, 70.39, 64.86, 
            61.17)), 4))
    if (cp == 0.3) 
        cen <- t(matrix(runif(4 * n, 0, c(41.27, 24.35, 23.34, 
            22.53)), 4))
    if (cp == 0.5) 
        cen <- t(matrix(runif(4 * n, 0, c(23.55, 14.07, 13.62, 
            13.43)), 4))
    if (cp == 0.7) 
        cen <- t(matrix(runif(4 * n, 0, c(14.2, 8.49, 8.36, 8.5)), 
            4))
    Y <- (-log(u))^(1/k)/((-log(q))^(1/k)/exp(X %*% t(b)))
    Z <- pmin(Y, cen)
    delta <- 1 * (Y <= cen)
    colnames(X) <- 1:2
    data.frame(Z = Z, X = X, d = delta)
}
Browse[2]> 
debug at /tmp/simdat.R!1724kxk#2: k <- 2
Browse[2]> 
debug at /tmp/simdat.R!1724kxk#3: X <- model.matrix(~sample(0:1, n, TRUE))
Browse[2]> 
debug at /tmp/simdat.R!1724kxk#5: b0 <- log(5)
Browse[2]> 
debug at /tmp/simdat.R!1724kxk#6: t0 <- 0:3
Browse[2]> 
debug at /tmp/simdat.R!1724kxk#7: if (sce == 1) b <- matrix(c(1.609438, 1.410748, 1.219403, 1.040613, 
    0, 0, 0, 0), 4) else b <- matrix(c(1.609438, 1.410748, 1.219403, 
    1.040613, 0.6931472, 0.7974189, 0.9070615, 1.0174711), 4)
Browse[2]> dim(X %*% t(b))
Error in t(b) : object 'b' not found
Browse[2]>
debug at /tmp/simdat.R!1724kxk#7: b <- matrix(c(1.609438, 1.410748, 1.219403, 1.040613, 0, 0, 0, 
    0), 4)
Browse[2]> 
debug at /tmp/simdat.R!1724kxk#10: u <- runif(n)
Browse[2]> dim(X %*% t(b))
[1] 10  4
Browse[2]> X
   (Intercept) sample(0:1, n, TRUE)
1            1                    1
2            1                    1
3            1                    1
4            1                    0
5            1                    0
6            1                    1
7            1                    0
8            1                    0
9            1                    0
10           1                    1
attr(,"assign")
[1] 0 1
Browse[2]> apply(X, 1, cumsum)
                     1 2 3 4 5 6 7 8 9 10
(Intercept)          1 1 1 1 1 1 1 1 1  1
sample(0:1, n, TRUE) 2 2 2 1 1 2 1 1 1  2
Browse[2]> apply(X, 1, cumsum) %*% b
Error in apply(X, 1, cumsum) %*% b (from simdat.R!1724kxk#10) : non-conformable arguments
Browse[2]> b %*% apply(X, 1, cumsum)
            1        2        3        4        5        6        7        8
[1,] 1.609438 1.609438 1.609438 1.609438 1.609438 1.609438 1.609438 1.609438
[2,] 1.410748 1.410748 1.410748 1.410748 1.410748 1.410748 1.410748 1.410748
[3,] 1.219403 1.219403 1.219403 1.219403 1.219403 1.219403 1.219403 1.219403
[4,] 1.040613 1.040613 1.040613 1.040613 1.040613 1.040613 1.040613 1.040613
            9       10
[1,] 1.609438 1.609438
[2,] 1.410748 1.410748
[3,] 1.219403 1.219403
[4,] 1.040613 1.040613
Browse[2]> b
         [,1] [,2]
[1,] 1.609438    0
[2,] 1.410748    0
[3,] 1.219403    0
[4,] 1.040613    0
Browse[2]> 
debug at /tmp/simdat.R!1724kxk#11: if (cp == Inf) cen <- Inf
Browse[2]> 